{% extends "base.html" %}
{% load static %}
{% url 'login' as login %}
{%block titleblock%} SocioClub | Sec Complain {% endblock %}


{%block cssblock%}
<link rel="stylesheet" href="{% static 'css/sec-complain.css'%}">
<!-- <link rel="stylesheet" href="{% static 'css/global.css'%}"> -->
{%endblock%}
{% block mainblock %}



<div class="sec-container">

    <div class="sec-left">
        <h3>Secretary Complain</h3>
        <hr>
        <div class="only-table-main">

            <table>

                <thead>

                    <tr>
                        <th class="th-1">Date</th>
                        <th class="th-2">Flat No. </th>
                        <th class="th-3">Complain Description </th>
                        <th class="th-4">Solution</th>
                        <th class="th-5">Complain Type</th>
                        <th></th>
                    </tr>

                </thead>
                <!-- {% for m in maintenance_data %}
            <tr>
                <td>{{flat}}</td>
                <td>option1</td>
                <td>{{m.maintenance_month}}</td>
                <td>{{m.maintenance_year}}</td>

                {% if m.payment_date == "" %}
                    <td>Not Paid</td>
                {% else %}
                    <td>{{m.payment_date}}</td>
                {% endif %}

            </tr>

            {% endfor %} -->
                <tbody>

                    {%if complains%}

                    {% for c in complains %}
                    <tr>
                        <td data-column="Date">{{c.complain_date}}</td>
                        <td data-column="Flat Name">{{c.flat}}</td>
                        <td data-column="Complain Description">{{c.complain_description}}</td>
                        <td data-column="Solution">{{c.complain_solution}}</td>
                        <td data-column="Complain Type">{{c.complain_type}}</td>
                        <td> <button class="select-btn"
                                onclick="select_complain('{{c.id}}','{{c.complain_date}}' , '{{c.flat}}' ,'{{c.complain_type}}')">Select</button>
                        </td>
                        <!-- <td> <button class="select-btn red ">Delete</button></td> -->
                    </tr>
                    {% endfor %}

                    {%else%}

                    <td data-column="Date">No Records Found</td>
                    <td data-column="Flat no">No Records Found</td>
                    <td data-column="Complain Decription">No Records Found</td>
                    <td data-column="Solution">No Records Found</td>
                    <td data-column="Complain Type">No Records Found</td>


                    {%endif%}

                </tbody>


            </table>

        </div>
    </div>

    <div class="sec-right">
        <div class="sec-right-text">
            <!-- <p>** If the Maintenance Amount is already paid , and it's not showing in the history table kindly request to
                the secratory by submitting the below form. **</p>
            <h5>Thanks for the Consideration</h5> -->

        </div>

        <div class="sec-right-form">
            <form action="{% url 'sec_complain' %}" method="POST" id="update_form">
                {% csrf_token %}

                <label>Date</label>
                <input type="text" placeholder="Date" name="complain_date" id="complain_date" readonly>
                <label>Flat No.</label>
                <input type="text" placeholder="Flat No." name="complain_flat" id="complain_flat" readonly>
                <label>Complain Type</label>
                <input type="text" placeholder="Complain type" name="complain_type" id="complain_type" readonly> 
                <label>Solution</label>
                <textarea id="complain_solution" name="complain_solution" rows="10" placeholder="Complain Solution"
                    maxlength="500" required  ></textarea>
                <!-- <label>Payment Date</label>
                <input type="text"> -->

                <div class="add-update">

                    <!-- <input type="submit" value="Add"> -->
                    <input type="submit" value="Update">
                </div>


            </form>

        </div>
    </div>

</div>

<script>

    var update_id = 0;

    console.log("Working js");

    complain_date = document.getElementById("complain_date");
    complain_flat = document.querySelector("#complain_flat");
    complain_type = document.querySelector("#complain_type");


    function select_complain(id, date, flat, type) {

        update_id = id;

        console.log("Update ID is: " + update_id)


        complain_date.value = date;
        complain_flat.value = flat;
        complain_type.value = type;

        document.getElementById("update_form").action = "http://127.0.0.1:8000/update_complain/" + update_id +"/";
        console.log(document.getElementById("update_form").action);

    }
</script>

<!-- <h1>
    Events
</h1>
<form method="POST" ">
    {% csrf_token %}

    <input type="text" placeholder="Name" name="event-name">
    <input type="number" placeholder="Decription" name="event-desc">
    <input type="number" placeholder="Start Date" name="event-start-date">
    <input type="text" placeholder="End Date" name="event-end-date" >
    <input type="submit">
</form>

<h1>Complain</h1>
<form method="POST" %}">
    {% csrf_token %}

    <input type="text" placeholder="Status" name="complain-status">
    
    <input type="submit">
</form> -->



{% endblock %}